# 2019.12.08 Dev Fest Osaka LTネタ

## 発表タイトル
タイトル未定

## 話すネタ
ビッグデータ分析基盤の移管で一番苦労したデータ参照について話す。


## スライド構成
- 自己紹介
- 旧基盤の問題点  
Redshiftを参照する自作のデータ集計システムが可動
  - 作ったの2013年…  
  - クソデカCSVダウンロードしたら落ちる
  - そもそもアプリケーションの面倒見たくない
  - Redshift高いお

- BigQueryに移行した実現方法
  - Embulkで連携してるよ
  - 更新データの扱い（巷であるのROW NUMBERで実施

- 一番苦労した点
  - なんといってもビッグデータはデータを入れたら終わりじゃない
  - データを参照できないといけない（しかもエンジニア以外も

- 試したこと
  - Metabaseを使う（発行されるSQLではパーティション分割テーブルに対応できない
  - 普通の？BigQuery to スプレッドシート使う（SQLが必要だった。これはMetabaseがSQL吐くのでそれをコピペすればいい運用にしようと思った。けど、取得最大が1万行という制約の前に撃沈
  - Google Apps ScriptでSQLの結果をシートに出力（出力がめっちゃ重い。プログラム修正した場合のアドオン配布面倒

- 解決した方法
  - Connected SheetsのBeta版申し込んでたらこんなメールが！（実際に来たメールをスクショ
  - それから使えるようになったのを気づいたのが何日

- 使用方法
  - この辺グラフ、ピボット、解答のスクショ
  - これでエンジニア以外でも簡単にデータが取り出せる（めでたしめでたし

- まとめ  
  - ビッグデータを格納・集約するのも大事だが、取り出しも容易にできるのを考える必要がある
  - Connected Sheetsを使えば今までのBigQuery連携とは違いSQLいらずなのでエンジニア以外も気軽に使うことができる
  - BigQuery上のROWデータを使えばスプレッドシートの最大セル数をあっという間に上限になるので用法用量を持って使う
